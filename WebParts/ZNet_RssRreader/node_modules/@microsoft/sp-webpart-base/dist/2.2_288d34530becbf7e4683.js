webpackJsonp974a7777_0990_4136_8fa6_95d80114c2e0_1_7_0([2],{

/***/ 126:
/***/ (function(module, exports, __webpack_require__) {

var content = __webpack_require__(127);
var loader = __webpack_require__(7);

if(typeof content === "string") content = [[module.i, content]];

// add the styles to the DOM
for (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], true);

if(content.locals) module.exports = content.locals;

/***/ }),

/***/ 127:
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__(8)(false);
// imports


// module
exports.push([module.i, ".spIFramePropertyPaneContainer_303e49ea{top:0;width:340px;position:relative;z-index:999;border-left-color:#eaeaea;border-left-style:solid;border-left-width:1px;transition:width 367ms cubic-bezier(.1,.9,.2,1);-webkit-transition:width 367ms cubic-bezier(.1,.9,.2,1)}[id^=spIFramePropertyPaneContainer].showPane_303e49ea{right:0;border-left-color:#eaeaea;border-left-style:solid;border-left-width:1px;bottom:0;background-color:#000}[id^=spIFramePropertyPaneContainer].showPane_303e49ea button{display:block}[id^=spIFramePropertyPaneContainer].hidePane_303e49ea{width:0;transition:width 367ms cubic-bezier(.1,.9,.2,1);-webkit-transition:width 367ms cubic-bezier(.1,.9,.2,1)}[dir=ltr] [id^=spPageChromeAppDiv].shrinkContent_303e49ea{right:340px}[dir=rtl] [id^=spPageChromeAppDiv].shrinkContent_303e49ea{left:340px}.iframeWebPart_303e49ea{width:100%;height:100%;height:-webkit-fill;height:-moz-fill;border:0}.iframePropertyPane_303e49ea{width:340px;height:100%;float:left;border:none}", ""]);

// exports


/***/ }),

/***/ 142:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });

// EXTERNAL MODULE: external "@microsoft/sp-lodash-subset"
var sp_lodash_subset_ = __webpack_require__(6);
var sp_lodash_subset__default = /*#__PURE__*/__webpack_require__.n(sp_lodash_subset_);

// EXTERNAL MODULE: external "@microsoft/sp-diagnostics"
var sp_diagnostics_ = __webpack_require__(4);
var sp_diagnostics__default = /*#__PURE__*/__webpack_require__.n(sp_diagnostics_);

// EXTERNAL MODULE: external "@microsoft/sp-core-library"
var sp_core_library_ = __webpack_require__(0);
var sp_core_library__default = /*#__PURE__*/__webpack_require__.n(sp_core_library_);

// CONCATENATED MODULE: ./lib/chunks/IframedWebPartController/IframedPropertyPane.module.scss.js
__webpack_require__(126);
var styles = {
    spIFramePropertyPaneContainer: 'spIFramePropertyPaneContainer_303e49ea',
    showPane: 'showPane_303e49ea',
    hidePane: 'hidePane_303e49ea',
    shrinkContent: 'shrinkContent_303e49ea',
    iframeWebPart: 'iframeWebPart_303e49ea',
    iframePropertyPane: 'iframePropertyPane_303e49ea',
};
/* harmony default export */ var IframedPropertyPane_module_scss = (styles);

// CONCATENATED MODULE: ./lib/chunks/IframedWebPartController/IframedWebPartController.js




var LOG_SOURCE = sp_diagnostics_["_LogSource"].create('IframedWebPartController');
var WEBPART_IFRAME_ID_PREFIX = 'dom-isolated-webpart';
var PROPERTYPANE_IFRAME_ID = 'dom-isolated-property-pane';
var IFRAMED_PROPERTYPANE_CONTAINER_ID = 'spIFramePropertyPaneContainer';
var IframedWebPartController_IframedWebPartController = (function () {
    function IframedWebPartController(host) {
        this._iframeSrcUrl = undefined;
        this._iframedWebparts = new Map();
        this._host = host;
        this._ppIframeElement = undefined;
        this._updateWebPartData = this._updateWebPartData.bind(this);
        this._updateWebPartDisplayMode = this._updateWebPartDisplayMode.bind(this);
        this._iframeEventListener = this._iframeEventListener.bind(this);
        window.addEventListener('message', this._iframeEventListener);
    }
    IframedWebPartController.prototype.deleteWebPart = function (instanceId) {
        sp_core_library_["Validate"].isNonemptyString(instanceId, 'instanceId');
        var metadata = this._iframedWebparts.get(instanceId);
        var iframePropertyPaneElement = document.getElementById(PROPERTYPANE_IFRAME_ID);
        if (iframePropertyPaneElement) {
            var messageToPropertyPane = {
                instanceId: instanceId,
                action: "iframeDeleteWebPart" 
            };
            iframePropertyPaneElement.contentWindow.postMessage(messageToPropertyPane, metadata.url);
        }
        this.requestPropertyPaneAction(2 );
        this._iframedWebparts.delete(instanceId);
    };
    IframedWebPartController.prototype.getAllInstanceIds = function () {
        var instanceIds = [];
        this._iframedWebparts.forEach(function (value, key) {
            instanceIds.push(key);
        });
        return instanceIds;
    };
    IframedWebPartController.prototype.notifyContainerResize = function (instanceId) {
    };
    IframedWebPartController.prototype.startDirtyBitTimer = function (instanceId) {
    };
    IframedWebPartController.prototype.loadWebPart = function (domainUrl, pageContext, webPartManagerContext) {
        this._iframeSrcUrl = this._generateIframeSrcUrl(domainUrl, pageContext, webPartManagerContext);
        sp_core_library_["Validate"].isNotNullOrUndefined(webPartManagerContext.webPartData, 'webPartData');
        var metadata = {
            origin: domainUrl,
            url: this._iframeSrcUrl,
            webPartData: webPartManagerContext.webPartData,
            webPartElementId: WEBPART_IFRAME_ID_PREFIX + "-" + webPartManagerContext.instanceId,
            displayMode: webPartManagerContext.displayMode
        };
        if (!this._iframedWebparts.has(webPartManagerContext.instanceId)) {
            this._iframedWebparts.set(webPartManagerContext.instanceId, metadata);
        }
        webPartManagerContext.domElement.innerHTML = "<div>\n      <iframe\n        id=" + metadata.webPartElementId + "\n        src=" + metadata.url + "\n        class=" + IframedPropertyPane_module_scss.iframeWebPart + "\n      ></iframe>\n    </div>";
    };
    IframedWebPartController.prototype.requestPropertyPaneAction = function (propertyPaneState, instanceId) {
        sp_core_library_["Validate"].isNotNullOrUndefined(propertyPaneState, 'propertyPaneState');
        switch (propertyPaneState) {
            case 1 :
                sp_core_library_["Validate"].isNonemptyString(instanceId, 'instanceId');
                if (!this._ppIframeElement) {
                    this._createPropertyPaneElement(instanceId);
                }
                this._showPropertyPane(instanceId);
                break;
            case 2 :
                if (this._ppIframeElement) {
                    this._hidePropertyPane(instanceId);
                }
                break;
            case 3 :
                sp_core_library_["Validate"].isNonemptyString(instanceId, 'instanceId');
                if (this._iframedPropertyPaneContainer &&
                    this._iframedPropertyPaneContainer.classList.contains(IframedPropertyPane_module_scss.showPane)) {
                    this._hidePropertyPane(instanceId);
                }
                else {
                    if (!this._iframedPropertyPaneContainer) {
                        this._createPropertyPaneElement(instanceId);
                    }
                    this._showPropertyPane(instanceId);
                }
                break;
            case 4 :
                break;
        }
    };
    IframedWebPartController.prototype.serialize = function (instanceId) {
        sp_core_library_["Validate"].isNonemptyString(instanceId, 'instanceId');
        var metadata = this._iframedWebparts.get(instanceId);
        return metadata.webPartData;
    };
    IframedWebPartController.prototype.setDisplayMode = function (displayMode, instanceId) {
        sp_core_library_["Validate"].isNotNullOrUndefined(displayMode, 'displayMode');
        sp_core_library_["Validate"].isNonemptyString(instanceId, 'instanceId');
        var messageToRenderedWebPart = {
            instanceId: instanceId,
            action: "iframeSetDisplayMode" ,
            displayMode: displayMode
        };
        var metadata = this._iframedWebparts.get(instanceId);
        metadata.displayMode = displayMode;
        var iframeWebPartElement = document.getElementById(metadata.webPartElementId);
        if (iframeWebPartElement) {
            iframeWebPartElement.contentWindow.postMessage(messageToRenderedWebPart, metadata.url);
        }
    };
    IframedWebPartController.prototype._generateIframeSrcUrl = function (domainUrl, pageContext, webPartManagerContext) {
        var iframeSrcUrl = domainUrl + "/_layouts/15/webpart.aspx?list=%7B";
        iframeSrcUrl += pageContext.list.id;
        iframeSrcUrl += '%7D&id=';
        iframeSrcUrl += pageContext.listItem.id;
        iframeSrcUrl += '&webPartInstanceId=';
        iframeSrcUrl += webPartManagerContext.instanceId;
        iframeSrcUrl += '&parentWindowOrigin=';
        iframeSrcUrl += window.location.origin;
        iframeSrcUrl += '&componentId=';
        iframeSrcUrl += webPartManagerContext.manifest.id;
        iframeSrcUrl += '&hostedInCanvas';
        return iframeSrcUrl;
    };
    IframedWebPartController.prototype._createPropertyPaneElement = function (instanceId) {
        if (!this._pageContentElement) {
            this._pageContentElement = document.getElementById('spPageChromeAppDiv');
        }
        if (!this._iframedPropertyPaneContainer) {
            this._iframedPropertyPaneContainer = document.createElement('div');
            this._iframedPropertyPaneContainer.id = IFRAMED_PROPERTYPANE_CONTAINER_ID;
            this._iframedPropertyPaneContainer.className = IframedPropertyPane_module_scss.spIFramePropertyPaneContainer;
            this._iframedPropertyPaneContainer.classList.add(IframedPropertyPane_module_scss.showPane);
        }
        var metadata = this._iframedWebparts.get(instanceId);
        this._iframeSrcUrl = metadata.url;
        this._iframeSrcUrl += '&openPropertyPane=true';
        this._iframedPropertyPaneContainer.innerHTML = "\n      <iframe\n        id=" + PROPERTYPANE_IFRAME_ID + "\n        src=" + this._iframeSrcUrl + "\n        class=" + IframedPropertyPane_module_scss.iframePropertyPane + "\n      ></iframe>";
        var parent = this._pageContentElement.parentElement;
        parent.appendChild(this._iframedPropertyPaneContainer);
        this._ppIframeElement = document.getElementById(PROPERTYPANE_IFRAME_ID);
        this._ppIframeElement.src = this._iframeSrcUrl;
    };
    IframedWebPartController.prototype._iframeEventListener = function (event) {
        if (this._iframedWebparts.has(event.data.instanceId)) {
            var metadata = this._iframedWebparts.get(event.data.instanceId);
            if (metadata && metadata.origin.toLowerCase() === event.origin.toLowerCase()) {
                var eventData = event.data;
                sp_core_library_["Validate"].isNotNullOrUndefined(eventData.action, 'action');
                switch (eventData.action) {
                    case "iframeRequestDisplayMode" :
                        this._updateWebPartDisplayMode(eventData.instanceId);
                        break;
                    case "iframeSetDimensions" :
                        sp_core_library_["Validate"].isNotNullOrUndefined(eventData.height, 'height');
                        var iframeWebPartElement = document.getElementById(metadata.webPartElementId);
                        sp_core_library_["Validate"].isNotNullOrUndefined(iframeWebPartElement, 'iframedWebPartElement');
                        iframeWebPartElement.style.height = eventData.height + "px";
                        break;
                    case "iframeUpdateWebPartData" :
                        sp_core_library_["Validate"].isNotNullOrUndefined(eventData.webPartData, 'webPartData');
                        this._updateWebPartData(eventData.instanceId, eventData.webPartData, "iframeUpdateWebPartData" );
                        break;
                    case "iframeUpdatePropertyPaneData" :
                        sp_core_library_["Validate"].isNotNullOrUndefined(eventData.webPartData, 'webPartData');
                        this._updateWebPartData(eventData.instanceId, eventData.webPartData, "iframeUpdatePropertyPaneData" );
                        break;
                    case "iframePropertyPaneLifeCycle" :
                        switch (eventData.propertyPaneLifeCycleEvent) {
                            case 4 :
                                this._hidePropertyPane(event.data.instanceId);
                        }
                        break;
                    default:
                        break;
                }
            }
        }
    };
    IframedWebPartController.prototype._updateWebPartDisplayMode = function (instanceId) {
        var metadata = this._iframedWebparts.get(instanceId);
        var messageToIframe = {
            instanceId: instanceId,
            displayMode: metadata.displayMode,
            action: "iframeSetDisplayMode" 
        };
        var iframeWebPartElement = document.getElementById(metadata.webPartElementId);
        if (iframeWebPartElement) {
            iframeWebPartElement.contentWindow.postMessage(messageToIframe, metadata.url);
        }
    };
    IframedWebPartController.prototype._updateWebPartData = function (instanceId, webPartData, action) {
        var metadata = this._iframedWebparts.get(instanceId);
        if (!sp_lodash_subset_["isEqual"](webPartData, metadata.webPartData)) {
            metadata.webPartData = webPartData;
            this._iframedWebparts.set(instanceId, metadata);
            this._host.setDirty(instanceId);
            var message = {
                instanceId: instanceId,
                webPartData: webPartData,
                action: "iframeSetWebPartData" 
            };
            switch (action) {
                case "iframeUpdatePropertyPaneData" :
                    var iframePropertyPaneElement = document.getElementById(PROPERTYPANE_IFRAME_ID);
                    if (iframePropertyPaneElement) {
                        iframePropertyPaneElement.contentWindow.postMessage(message, metadata.url);
                    }
                    break;
                case "iframeUpdateWebPartData" :
                    var iframeWebPartElement = document.getElementById(metadata.webPartElementId);
                    if (iframeWebPartElement) {
                        iframeWebPartElement.contentWindow.postMessage(message, metadata.url);
                    }
                    break;
                default:
                    sp_diagnostics_["_TraceLogger"].logError(LOG_SOURCE, new Error('Invalid parameter "action"'));
                    break;
            }
        }
    };
    IframedWebPartController.prototype._hidePropertyPane = function (webPartInstanceId) {
        if (this._iframedPropertyPaneContainer) {
            if (webPartInstanceId) {
                var eventData = {
                    instanceId: webPartInstanceId,
                    action: "iframeRequestPropertyPaneAction" ,
                    propertyPaneAction: 2 
                };
                var metadata = this._iframedWebparts.get(webPartInstanceId);
                this._ppIframeElement.contentWindow.postMessage(eventData, metadata.url);
            }
            this._iframedPropertyPaneContainer.classList.remove(IframedPropertyPane_module_scss.showPane);
            this._iframedPropertyPaneContainer.classList.add(IframedPropertyPane_module_scss.hidePane);
            this._pageContentElement.classList.remove(IframedPropertyPane_module_scss.shrinkContent);
        }
    };
    IframedWebPartController.prototype._showPropertyPane = function (webPartInstanceId) {
        if (webPartInstanceId && this._iframedWebparts.has(webPartInstanceId)) {
            var metadata = this._iframedWebparts.get(webPartInstanceId);
            this._ppIframeElement.src = metadata.url + "&openPropertyPane=true";
            var eventData = {
                instanceId: webPartInstanceId,
                action: "iframeRequestPropertyPaneAction" ,
                propertyPaneAction: 1 
            };
            this._ppIframeElement.contentWindow.postMessage(eventData, metadata.url);
        }
        this._iframedPropertyPaneContainer.classList.add(IframedPropertyPane_module_scss.showPane);
        this._iframedPropertyPaneContainer.classList.remove(IframedPropertyPane_module_scss.hidePane);
        this._pageContentElement.classList.add(IframedPropertyPane_module_scss.shrinkContent);
    };
    return IframedWebPartController;
}());
/* harmony default export */ var chunks_IframedWebPartController_IframedWebPartController = __webpack_exports__["default"] = (IframedWebPartController_IframedWebPartController);


/***/ })

});
//# sourceMappingURL=2.2_288d34530becbf7e4683.js.map