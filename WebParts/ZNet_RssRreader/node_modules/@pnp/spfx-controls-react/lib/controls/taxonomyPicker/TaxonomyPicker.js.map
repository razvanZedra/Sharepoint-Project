{"version":3,"sources":["controls/taxonomyPicker/TaxonomyPicker.tsx"],"names":[],"mappings":"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","file":"controls/taxonomyPicker/TaxonomyPicker.js","sourcesContent":["import * as React from 'react';\nimport { PrimaryButton, DefaultButton, IconButton } from 'office-ui-fabric-react/lib/Button';\nimport { Panel, PanelType } from 'office-ui-fabric-react/lib/Panel';\nimport { Spinner, SpinnerType } from 'office-ui-fabric-react/lib/Spinner';\nimport { Label } from 'office-ui-fabric-react/lib/Label';\nimport TermPicker from './TermPicker';\nimport { IPickerTerms, IPickerTerm } from './ITermPicker';\nimport { ITaxonomyPickerProps, ITaxonomyPickerState } from './ITaxonomyPicker';\nimport SPTermStorePickerService from './../../services/SPTermStorePickerService';\nimport { ITermSet, IGroup, ITerm } from './../../services/ISPTermStorePickerService';\nimport styles from './TaxonomyPicker.module.scss';\nimport { sortBy, uniqBy, cloneDeep, isEqual } from '@microsoft/sp-lodash-subset';\nimport TermParent from './TermParent';\nimport FieldErrorMessage from './ErrorMessage';\nimport * as telemetry from '../../common/telemetry';\n\n\n/**\n * Image URLs / Base64\n */\nexport const COLLAPSED_IMG = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAUCAYAAABSx2cSAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAABh0RVh0U29mdHdhcmUAUGFpbnQuTkVUIHYzLjEwcrIlkgAAAIJJREFUOE/NkjEKwCAMRdu7ewZXJ/EqHkJwE9TBCwR+a6FLUQsRwYBTeD8/35wADnZVmPvY4OOYO3UNbK1FKeUWH+fRtK21hjEG3vuhQBdOKUEpBedcV6ALExFijJBSIufcFBjCVSCEACEEqpNvBmsmT+3MTnvqn/+O4+1vdtv7274APmNjtuXVz6sAAAAASUVORK5CYII='; // /_layouts/15/images/MDNCollapsed.png\nexport const EXPANDED_IMG = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAUCAYAAABSx2cSAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAABh0RVh0U29mdHdhcmUAUGFpbnQuTkVUIHYzLjEwcrIlkgAAAFtJREFUOE9j/P//PwPZAKSZXEy2RrCLybV1CGjetWvX/46ODqBLUQOXoJ9BGtXU1MCYJM0wjZGRkaRpRtZIkmZ0jSRpBgUOzJ8wmqwAw5eICIb2qGYSkyfNAgwAasU+UQcFvD8AAAAASUVORK5CYII='; // /_layouts/15/images/MDNExpanded.png\nexport const GROUP_IMG = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAC9SURBVDhPY2CgNXh1qEkdiJ8D8X90TNBuJM0V6IpBhoHFgIxebKYTIwYzAMNpxGhGdsFwNoBgNEFjAWsYgOSKiorMgPgbEP/Hgj8AxXpB0Yg1gQAldYuLix8/efLkzn8s4O7du9eAan7iM+DV/v37z546der/jx8/sJkBdhVOA5qbm08ePnwYrOjQoUOkGwDU+AFowLmjR4/idwGukAYaYAkMgxfPnj27h816kDg4DPABoAI/IP6DIxZA4l0AOd9H3QXl5+cAAAAASUVORK5CYII='; // /_layouts/15/Images/EMMGroup.png\nexport const TERMSET_IMG = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAACaSURBVDhPrZLRCcAgDERdpZMIjuQA7uWH4CqdxMY0EQtNjKWB0A/77sxF55SKMTalk8a61lqCFqsLiwKac84ZRUUBi7MoYHVmAfjfjzE6vJqZQfie0AcwBQVW8ATi7AR7zGGGNSE6Q2cyLSPIjRswjO7qKhcPDN2hK46w05wZMcEUIG+HrzzcrRsQBIJ5hS8C9fGAPmRwu/9RFxW6L8CM4Ry8AAAAAElFTkSuQmCC'; // /_layouts/15/Images/EMMTermSet.png\nexport const TERM_IMG = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAACzSURBVDhPY2AYNKCoqIgTiOcD8X8S8F6wB4Aa1IH4akNDw+mPHz++/E8EuHTp0jmQRSDNCcXFxa/XrVt3gAh9KEpgBvx/9OjRLVI1g9TDDYBp3rlz5//Kysr/IJoYgGEASPPatWsbQDQxAMOAbdu2gZ0FookBcAOePHlyhxgN6GqQY+Hdhg0bDpJqCNgAaDrQAnJuNDY2nvr06dMbYgw6e/bsabgBUEN4yEiJ2wdNViLfIQC3sTh2vtJcswAAAABJRU5ErkJggg==';\n\n/**\n * Renders the controls for PropertyFieldTermPicker component\n */\nexport class TaxonomyPicker extends React.Component<ITaxonomyPickerProps, ITaxonomyPickerState> {\n  private termsService: SPTermStorePickerService;\n  private previousValues: IPickerTerms = [];\n  private cancel: boolean = true;\n\n  /**\n   * Constructor method\n   */\n  constructor(props: ITaxonomyPickerProps) {\n    super(props);\n\n    telemetry.track('ReactTaxonomyPicker');\n\n    this.state = {\n      activeNodes: this.props.initialValues || [],\n      termSetAndTerms: null,\n      loaded: false,\n      openPanel: false,\n      errorMessage: ''\n    };\n\n    this.onOpenPanel = this.onOpenPanel.bind(this);\n    this.onClosePanel = this.onClosePanel.bind(this);\n    this.onSave = this.onSave.bind(this);\n    this.termsChanged = this.termsChanged.bind(this);\n    this.termsFromPickerChanged = this.termsFromPickerChanged.bind(this);\n  }\n\n  /**\n   * componentWillMount lifecycle hook\n   */\n  public componentWillMount(): void {\n    this.setState({\n      activeNodes: this.props.initialValues || []\n    });\n  }\n\n  /**\n   * componentWillUpdate lifecycle hook\n   */\n  public componentDidUpdate(prevProps: ITaxonomyPickerProps): void {\n    // Check if the initial values objects are not equal, if that is the case, data can be refreshed\n    if (!isEqual(this.props.initialValues, prevProps.initialValues)) {\n      this.setState({\n        activeNodes: this.props.initialValues || []\n      });\n    }\n  }\n\n  /**\n   * Loads the list from SharePoint current web site\n   */\n  private loadTermStores(): void {\n    this.termsService = new SPTermStorePickerService(this.props, this.props.context);\n    this.termsService.getAllTerms(this.props.termsetNameOrID).then((response: ITermSet) => {\n      // Check if a response was retrieved\n      if (response !== null) {\n        this.setState({\n          termSetAndTerms: response,\n          loaded: true\n        });\n      } else {\n        this.setState({\n          termSetAndTerms: null,\n          loaded: true\n        });\n      }\n    });\n  }\n\n  /**\n   * Open the right Panel\n   */\n  private onOpenPanel(): void {\n    if (this.props.disabled === true) {\n      return;\n    }\n\n    // Store the current code value\n    this.previousValues = cloneDeep(this.state.activeNodes);\n    this.cancel = true;\n\n    this.loadTermStores();\n\n    this.setState({\n      openPanel: true,\n      loaded: false\n    });\n  }\n\n  /**\n   * Close the panel\n   */\n  private onClosePanel(): void {\n\n    this.setState(() => {\n      const newState: ITaxonomyPickerState = {\n        openPanel: false,\n        loaded: false\n      };\n\n      // Check if the property has to be reset\n      if (this.cancel) {\n        newState.activeNodes = this.previousValues;\n      }\n\n      return newState;\n    });\n  }\n\n  /**\n   * On save click action\n   */\n  private onSave(): void {\n    this.cancel = false;\n    this.onClosePanel();\n    // Trigger the onChange event\n    this.props.onChange(this.state.activeNodes);\n  }\n\n  /**\n   * Clicks on a node\n   * @param node\n   */\n  private termsChanged(term: ITerm, checked: boolean): void {\n\n    let activeNodes = this.state.activeNodes;\n    if (typeof term === 'undefined' || term === null) {\n      return;\n    }\n\n    // Term item to add to the active nodes array\n    const termItem = {\n      name: term.Name,\n      key: term.Id,\n      path: term.PathOfTerm,\n      termSet: term.TermSet.Id\n    };\n\n    // Check if the term is checked or unchecked\n    if (checked) {\n      // Check if it is allowed to select multiple terms\n      if (this.props.allowMultipleSelections) {\n        // Add the checked term\n        activeNodes.push(termItem);\n        // Filter out the duplicate terms\n        activeNodes = uniqBy(activeNodes, 'key');\n      } else {\n        // Only store the current selected item\n        activeNodes = [termItem];\n      }\n    } else {\n      // Remove the term from the list of active nodes\n      activeNodes = activeNodes.filter(item => item.key !== term.Id);\n    }\n    // Sort all active nodes\n    activeNodes = sortBy(activeNodes, 'path');\n    // Update the current state\n    this.setState({\n      activeNodes: activeNodes\n    });\n  }\n\n  /**\n * Fires When Items Changed in TermPicker\n * @param node\n */\n  private termsFromPickerChanged(terms: IPickerTerms) {\n    this.props.onChange(terms);\n    this.setState({\n      activeNodes: terms\n    });\n  }\n\n\n  /**\n   * Gets the given node position in the active nodes collection\n   * @param node\n   */\n  private getSelectedNodePosition(node: IPickerTerm): number {\n    for (let i = 0; i < this.state.activeNodes.length; i++) {\n      if (node.key === this.state.activeNodes[i].key) {\n        return i;\n      }\n    }\n    return -1;\n  }\n\n  /**\n   * TermSet selection handler\n   * @param termSet\n   * @param isChecked\n   */\n  private termSetSelectedChange = (termSet: ITermSet, isChecked: boolean) => {\n    const ts: ITermSet = {...termSet};\n    // Clean /Guid.../ from the ID\n    ts.Id = this.termsService.cleanGuid(ts.Id);\n    // Create a term for the termset\n    const term: ITerm = {\n      Name: ts.Name,\n      Id: ts.Id,\n      TermSet: ts,\n      PathOfTerm: \"\",\n      _ObjectType_: ts._ObjectType_,\n      _ObjectIdentity_: ts._ObjectIdentity_,\n      Description: ts.Description,\n      IsDeprecated: null,\n      IsAvailableForTagging: null,\n      IsRoot: null\n    };\n\n    // Trigger the normal change event\n    this.termsChanged(term, isChecked);\n  }\n\n  /**\n   * Renders the SPListpicker controls with Office UI  Fabric\n   */\n  public render(): JSX.Element {\n\n    return (\n      <div>\n        {this.props.label && <Label>{this.props.label}</Label>}\n        <div className={styles.termField}>\n          <div className={styles.termFieldInput}>\n            <TermPicker\n              context={this.props.context}\n              termPickerHostProps={this.props}\n              disabled={this.props.disabled}\n              value={this.state.activeNodes}\n              isTermSetSelectable={this.props.isTermSetSelectable}\n              onChanged={this.termsFromPickerChanged}\n              allowMultipleSelections={this.props.allowMultipleSelections}\n              disabledTermIds={this.props.disabledTermIds}\n              disableChildrenOfDisabledParents={this.props.disableChildrenOfDisabledParents} />\n          </div>\n          <div className={styles.termFieldButton}>\n            <IconButton disabled={this.props.disabled} iconProps={{ iconName: 'Tag' }} onClick={this.onOpenPanel} />\n          </div>\n        </div>\n\n        <FieldErrorMessage errorMessage={this.state.errorMessage} />\n\n        <Panel\n          isOpen={this.state.openPanel}\n          hasCloseButton={true}\n          onDismiss={this.onClosePanel}\n          isLightDismiss={true}\n          type={PanelType.medium}\n          headerText={this.props.panelTitle}\n          onRenderFooterContent={() => {\n            return (\n              <div className={styles.actions}>\n                <PrimaryButton iconProps={{ iconName: 'Save' }} text=\"Save\" value=\"Save\" onClick={this.onSave} />\n\n                <DefaultButton iconProps={{ iconName: 'Cancel' }} text=\"Cancel\" value=\"Cancel\" onClick={this.onClosePanel} />\n              </div>\n            );\n          }}>\n\n          {\n            /* Show spinner in the panel while retrieving terms */\n            this.state.loaded === false ? <Spinner type={SpinnerType.normal} /> : ''\n          }\n          {\n            this.state.loaded === true && this.state.termSetAndTerms && (\n              <div key={this.state.termSetAndTerms.Id} >\n                <h3>{this.state.termSetAndTerms.Name}</h3>\n                <TermParent anchorId={this.props.anchorId}\n                            autoExpand={null}\n                            termset={this.state.termSetAndTerms}\n                            isTermSetSelectable={this.props.isTermSetSelectable}\n                            termSetSelectedChange={this.termSetSelectedChange}\n                            activeNodes={this.state.activeNodes}\n                            disabledTermIds={this.props.disabledTermIds}\n                            disableChildrenOfDisabledParents={this.props.disableChildrenOfDisabledParents}\n                            changedCallback={this.termsChanged}\n                            multiSelection={this.props.allowMultipleSelections} />\n              </div>\n            )\n          }\n        </Panel>\n      </div >\n    );\n  }\n}\n"],"sourceRoot":"../../../src"}