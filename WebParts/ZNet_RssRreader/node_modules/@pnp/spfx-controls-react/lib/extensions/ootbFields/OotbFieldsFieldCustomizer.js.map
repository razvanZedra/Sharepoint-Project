{"version":3,"sources":["extensions/ootbFields/OotbFieldsFieldCustomizer.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAAA,6BAA+B;AAC/B,oCAAsC;AAEtC,8DAAiD;AACjD,oDAAiD;AACjD,kFAG8C;AAG9C,iEAAkF;AAClF,4DAA2D;AAC3D,2CAAsC;AACtC,sEAAqE;AAUrE,IAAM,UAAU,GAAW,2BAA2B,CAAC;AAEvD;IACU,6CAAyD;IADnE;QAAA,qEA+CC;QA5CW,4BAAsB,GAAY,KAAK,CAAC;;IA4CpD,CAAC;IAzCQ,0CAAM,GAAb;QACE,0EAA0E;QAC1E,oFAAoF;QACpF,qBAAG,CAAC,IAAI,CAAC,UAAU,EAAE,sDAAsD,CAAC,CAAC;QAE7E,EAAE,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,SAAS,KAAK,UAAU,IAAI,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,YAAY,KAAK,SAAS,CAAC,CAAC,CAAC;YACjG,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;QACrC,CAAC;QACD,MAAM,CAAC,qBAAO,CAAC,OAAO,EAAE,CAAC;IAC3B,CAAC;IAGM,gDAAY,GAAnB,UAAoB,KAA0C;QAD9D,iBAoBC;QAlBC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,sBAAsB,IAAI,CAAC,6BAAa,CAAC,SAAS,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;YAC/E,MAAM,CAAC;QACT,CAAC;QACD,IAAM,SAAS,GAAW,mBAAQ,CAAC,kBAAkB,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC;QACvF,mBAAQ,CAAC,YAAY,CAAC,KAAK,CAAC,UAAU,EAAE,KAAK,CAAC,QAAQ,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,UAAA,IAAI;YAC7E,IAAM,UAAU,GACd,KAAK,CAAC,aAAa,CAAC,oBAAU,EAAE;gBAC9B,IAAI,EAAE,IAAI;gBACV,KAAK,EAAE,KAAK,CAAC,UAAU;gBACvB,QAAQ,EAAE,KAAK,CAAC,QAAQ;gBACxB,SAAS,EAAE,SAAS;gBACpB,OAAO,EAAE,KAAI,CAAC,OAAO;gBACrB,wCAAwC;gBACxC,SAAS,EAAE,YAAY;aACxB,CAAC,CAAC;YAEL,QAAQ,CAAC,MAAM,CAAC,UAAU,EAAE,KAAK,CAAC,UAAU,CAAC,CAAC;QAChD,CAAC,CAAC,CAAC;IACL,CAAC;IAGM,iDAAa,GAApB,UAAqB,KAA0C;QAC7D,yFAAyF;QACzF,gFAAgF;QAChF,+CAA+C;QAC/C,QAAQ,CAAC,sBAAsB,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;QAClD,iBAAM,aAAa,YAAC,KAAK,CAAC,CAAC;IAC7B,CAAC;IAxCD;QADC,qBAAQ;2DAUR;IAGD;QADC,qBAAQ;iEAoBR;IAGD;QADC,qBAAQ;kEAOR;IACH,gCAAC;CA/CD,AA+CC,CA9CS,+CAAmB,GA8C5B;kBA/CoB,yBAAyB;AAiD9C,2LAA2L","file":"extensions/ootbFields/OotbFieldsFieldCustomizer.js","sourcesContent":["import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\n\nimport { Log } from '@microsoft/sp-core-library';\nimport { override } from '@microsoft/decorators';\nimport {\n  BaseFieldCustomizer,\n  IFieldCustomizerCellEventParameters\n} from '@microsoft/sp-listview-extensibility';\n\nimport * as strings from 'ControlStrings';\nimport OotbFields, { IOotbFieldsProps } from './components/Customizer/OotbFields';\nimport { SPHelper } from '../../common/utilities/SPHelper';\nimport { Promise } from 'es6-promise';\nimport { GeneralHelper } from '../../common/utilities/GeneralHelper';\n\n/**\n * If your field customizer uses the ClientSideComponentProperties JSON input,\n * it will be deserialized into the BaseExtension.properties object.\n * You can define an interface to describe it.\n */\nexport interface IOotbFieldsFieldCustomizerProperties {\n}\n\nconst LOG_SOURCE: string = 'OotbFieldsFieldCustomizer';\n\nexport default class OotbFieldsFieldCustomizer\n  extends BaseFieldCustomizer<IOotbFieldsFieldCustomizerProperties> {\n\n    private _shouldRenderUndefiend: boolean = false;\n\n  @override\n  public onInit(): Promise<void> {\n    // Add your custom initialization to this method.  The framework will wait\n    // for the returned promise to resolve before firing any BaseFieldCustomizer events.\n    Log.info(LOG_SOURCE, 'Activated OotbFieldsFieldCustomizer with properties:');\n\n    if (this.context.field.fieldType === 'Computed' && this.context.field.internalName === 'DocIcon') {\n      this._shouldRenderUndefiend = true;\n    }\n    return Promise.resolve();\n  }\n\n  @override\n  public onRenderCell(event: IFieldCustomizerCellEventParameters): void {\n    if (!this._shouldRenderUndefiend && !GeneralHelper.isDefined(event.fieldValue)) {\n      return;\n    }\n    const fieldName: string = SPHelper.getStoredFieldName(this.context.field.internalName);\n    SPHelper.getFieldText(event.fieldValue, event.listItem, this.context).then(text => {\n      const ootbFields: React.ReactElement<{}> =\n        React.createElement(OotbFields, {\n          text: text,\n          value: event.fieldValue,\n          listItem: event.listItem,\n          fieldName: fieldName,\n          context: this.context,\n          //cssProps: { backgroundColor: '#f00' },\n          className: 'fake-class'\n        });\n\n      ReactDOM.render(ootbFields, event.domElement);\n    });\n  }\n\n  @override\n  public onDisposeCell(event: IFieldCustomizerCellEventParameters): void {\n    // This method should be used to free any resources that were allocated during rendering.\n    // For example, if your onRenderCell() called ReactDOM.render(), then you should\n    // call ReactDOM.unmountComponentAtNode() here.\n    ReactDOM.unmountComponentAtNode(event.domElement);\n    super.onDisposeCell(event);\n  }\n}\n\n// test querystring ?loadSPFX=true&debugManifestsFile=https://localhost:4321/temp/manifests.js&fieldCustomizers={\"FieldName\":{\"id\":\"57ebd944-98ed-43f9-b722-e959d6dac6ad\",\"properties\":{}}}\n"],"sourceRoot":"../../../src"}